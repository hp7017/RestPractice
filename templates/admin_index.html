{% extends 'admin/index.html' %}
{% load static %}
{% block extrahead %}
	{{ block.super }}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		$(document).ready(function(){
			$('#email_dashboard_form_errors_list').hide()
			$('#email_dashboard_form').submit(function(e){
				$('#email_dashboard_form_errors_list').text('')
				e.preventDefault()
				$.ajax({
					url: "{% url 'email_dashboard' %}",
					type: 'post',
					data: new FormData($(this)[0]),
					processData: false,
					contentType: false,
					'success': function(data){
						console.log(data)
						if(data.errors) {
							for (field in data.errors){
								for (error in data.errors[field]){
									$("#email_dashboard_form_errors_list").append('<li>'+field+' - '+data.errors[field][error].message+'</li>')
								}
							}
							pos = $("#email_dashboard_form_errors_list").position()
							scrollTo(pos.left, pos.top-150)
							$('#email_dashboard_form_errors_list').show()
						}
						else {
							window.location.reload()
						}
					}
				})
			})
		})
	</script>
{% endblock %}
{% block extrastyle %}
	{{ block.super }}
	<link rel="stylesheet" type="text/css" href="{% static 'admin_index.css' %}">
{% endblock %}
{% load static %}
{% block content %}
	<div style="margin: 10px 0;">
		<form id="email_dashboard_form">
		{% csrf_token %}
			<details>
				<div class="errors">
					<ul id="email_dashboard_form_errors_list">
					</ul>
				</div>
				<summary style="background-color: #2980b9; border-radius: 10px; color: white; padding: 10px 20px;">Email Dashboard</summary>
				<div class="flex gap-10 vertical-center" style="margin: 10px 0">
					<p>From</p>
					<input type="text" name="from_email" disabled value="notify@librarygenesis.in" class="flex-grow">
				</div>
				<div class="flex gap-10 vertical-center" style="margin: 10px 0">
					<p>CC</p>
					<input type="text" name="cc" class="flex-grow">
				</div>
				<div class="flex gap-10 vertical-center" style="margin: 10px 0">
					<p>To</p>
					<input type="text" name="to" class="flex-grow">
				</div>
				<div class="flex gap-10 vertical-center" style="margin: 10px 0">
					<p>Subject</p>
					<input type="text" name="subject" class="flex-grow">
				</div>
				<textarea style="height: 200px; width: 97%;" name="body"></textarea>
				<div class="flex flex-end">
					<input type="submit" value="Send">
				</div>
				<div>
					<ol class="flex wrap gap-10 list-style-none clickable" style="padding: 0">
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
						<li style="background-color: #ecf0f1; padding: 2px 10px;">ABSF</li>
					</ol>
				</div>
			</details>
		</form>
	</div>
	{{block.super}}
{% endblock %}